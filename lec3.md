# 第3回目
## Processingによるアニメーション

### アニメーションの基礎
- 静止画を高速に切り替えることでアニメーションが実現できる
  - アニメーションにおいて，1秒間あたりに処理させる静止画像（フレーム）数のことをフレームレートとよぶ
  - 単位: fps（60fpsは1秒間に60フレーム切り替えている）

- Processingも同様に，各フレームを高速に切り替えることで，アニメーションを実現する
  - 初期化を行う```setup```ブロック（setup関数）と，フレームを描画する```draw```ブロック（draw関数）を定義する
  - それぞれインデントをずらして書くこと
    - **インデントでPythonは```setup```か```draw```かそれ以外かを区別している**

### アニメーションプログラム概要
```python
def setup():
  # 初期化処理をここに書く

def draw():
  # フレームごとの処理をここに書く
```
- ```setup```: 最初に1度だけ実行される
  - ウインドウのサイズ設定など1度だけ必要な処理をこの中に記述する
- ```draw```: フレームを表示するたびに実行される
  - ここで記載していることがアニメーションで表示される
    - デフォルトでは1秒間に60回実行される

### アニメーション例1
```python
# 1回だけ実行される
def setup():
    size(255, 255) # ウィンドウのサイズ

# setupを終えた後，繰り返し実行される
def draw():
    background(255, 255, 255) # 背景色を決める
    z = frameCount % 256
    ellipse(z, z, 30, 30)     # 円を描画する
```
- ```frameCount```: Processingが用意している特別な変数
  - プログラムが開始されてから表示されたフレーム数を保存
    - 0から始まり，```draw```が終わると1つ増える
  - 余りを利用して，変数zの値が0から255となるように設定

### アニメーション例2
- アニメーション例1のプログラムから『```background(255, 255, 255)```』を削除して実行した場合
```python
# 1回だけ実行される
def setup():
    size(255, 255) # ウィンドウのサイズ

# setupを終えた後，繰り返し実行される
def draw():
    z = frameCount % 256
    ellipse(z, z, 30, 30)  # 円を描画する
```

### アニメーション失敗例
```python
# 1回だけ実行される
def setup():
    size(255, 255) # ウィンドウのサイズ

# setupを終えた後，繰り返し実行される
def draw():
    x = 0
    background(255, 255, 255) # 背景色を決める
    ellipse(x, x, 30, 30)     # 円を描画する
    x += 1
```
- 各関数の中で宣言した変数は，その関数でしか利用できないため，グローバル変数を使用する

### グローバル変数
- ```setup```関数，```draw```関数の外側で変数を宣言することで，プログラムのどこからでも使用可能な変数のこと
  - プログラムが終わるまで，変数は存在する
    - draw関数が終わっとしても，値を維持できる

```python
# グローバル変数の宣言
x = 10

def setup():
  # 初期化処理をここに書く
  # グローバル変数xを使用できる

def draw():
  # フレームごとの処理をここに書く
  # グローバル変数xを使用できる
```

### グローバル変数の更新
- 関数中からグローバル変数の値を変更する場合，グローバル変数の値を変更する関数の先頭に ```global 変数名``` と記述する必要がある

```python
# グローバル変数の宣言
x = 10

def setup():
    # 初期化処理をここに書く
    size(600, 600)

def draw():
    # フレームごとの処理をここに書く
    global x # グローバル変数を変更するため
    print(x) # xの値を表示
    x += 1   # グローバル変数を変更
```

### アニメーション成功例
```python
# グローバル変数の宣言
x = 0

# 1回だけ実行される
def setup():
    size(600, 600) # ウィンドウのサイズ

# setupを終えた後，繰り返し実行される
def draw():
    global x
    background(255, 255, 255) # 背景色を決める
    fill(0, 200, 200)         # 円の塗りつぶし色を決める
    ellipse(x, x, 30, 30)     # 円を描画する
    x += 1
    x = x % (width + 1)       # 余りを使って，xを0からwidthにする
```

```python
# グローバル変数の宣言
x = 0

# 1回だけ実行される
def setup():
    size(600, 600) # ウィンドウのサイズ

# setupを終えた後，繰り返し実行される
def draw():
    global x
    background(255, 255, 255)     # 背景色を決める
    fill(200, 200, 0)             # 円の塗りつぶし色を決める
    ellipse(x, height/2, 60, 60)  # 円を描画する
    x += 1
    x = x % (width + 1)           # 余りを使って，xを0からwidthにする
```

```python
# グローバル変数の宣言
x = 0

# 1回だけ実行される
def setup():
    size(600, 600) # ウィンドウのサイズ

# setupを終えた後，繰り返し実行される
def draw():
    global x
    background(255, 255, 255)                 # 背景色を決める
    strokeWeight(4) 
    line(x, height/2 - 140, x, height/2 + 140)
    fill(200, 200, 0)                         # 円の塗りつぶし色を決める
    ellipse(x, height/2 - 140, 60, 60)        # 円を描画する
    fill(200, 0, 200)                         # 円の塗りつぶし色を決める
    ellipse(x, height/2 + 140, 60, 60)        # 円を描画する
    x += 1
    x = x % (width + 1)                       # 余りを使って，xを0からwidthにする
```

## 練習問題
- 大きさ600, 600の画面に対して，以下のプログラムを書きなさい
  1. 赤い円が縦方向に移動するアニメーション（横方向の位置は画面中央）
  2. 緑色の円が対角線上に移動するアニメーション（右上から左下に移動する）
  3. 2つの円が移動するアニメーション
     - 1つ目の円は横方向に移動する（縦方向の位置は画面中央）
     - 2つ目の円は縦方向に移動する（横方向の位置は画面中央）
  4. 2つの円が移動するアニメーション
     - 1つ目の円は左上から右下に移動する
     - 2つ目の円は右上から左下に移動する
  5. アニメーションの速度を変えるにはどうしたらよいか考えなさい
